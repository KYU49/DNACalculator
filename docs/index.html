<!--
    Copyright (c) 2025 KYU @ https://github.com/KYU49

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/agpl-3.0.html>.
-->

<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<title>DNA Calculator</title>
	<script src="script.js"></script>
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<h1>DNA Calculator</h1>

	<label>[Na+] /mM: <input type="number" id="naInput" value="50" class="conc-input"></label>
	<label>[Primer] /μM<sup>†</sup>: <input type="number" id="dnaInput" value="0.5" class="conc-input"></label><br>
	<small><sup>†</sup>When [DNA] &lt;&lt; [Primer], input the initial primer concentration. When [DNA] = [Primer], input 1/4 primer concentration.</small>
	<br><br>

	<div class="input-row">
		<div class="input-block">
			<label for="sequence" class="bold">5'- Sequence -3'</label>
			<textarea id="seq" rows="10" placeholder="Enter DNA sequence"></textarea>
		</div>
		<div class="input-block">
			<label for="abs" class="bold">Abs. @ 260 nm</label>
			<textarea id="abs" row="10" class="abs-textarea" placeholder="Abs. (optional)"></textarea>
		</div>
	</div>
	<ul>
		<li>Input one sequence per row.</li>
		<li>"Abs." is used only for concentration calculations.</li>
		<li>The mw value is calculated with the 5' end as -OH. </li>
		<li>By bookmarking the search results URL, the sequence information you entered will be preserved.</li>
		<li>An Excel version is also available on <a href="https://github.com/KYU49/DNACalculator" target="_blank">GitHub</a>.</li>
	</ul>
	<br>
	<button id="calculateBtn">Calculate</button>
	<button id="downloadBtn" disabled>Download TSV</button>
	<button id="clearBtn">Clear</button>

	<div id="results"></div>

	<hr>

	<h2>Values used for calculation</h2>
	<table class="auto-width-table">
		<thead>
			<tr>
				<th></th><th>pdA</th><th>pdC</th><th>pdG</th><th>pdT</th><th>dApdA</th><th>dApdC</th><th>dApdG</th><th>dApdT</th><th>dCpdA</th><th>dCpdC</th><th>dCpdG</th><th>dCpdT</th><th>dGpdA</th><th>dGpdC</th><th>dGpdG</th><th>dGpdT</th><th>dTpdA</th><th>dTpdC</th><th>dTpdG</th><th>dTpdT</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>ε(ss)</td><td>15400</td><td>7400</td><td>11500</td><td>8700</td><td>27400</td><td>21200</td><td>25000</td><td>22800</td><td>21200</td><td>14600</td><td>18000</td><td>15200</td><td>25200</td><td>17600</td><td>21600</td><td>20000</td><td>23400</td><td>16200</td><td>19000</td><td>16800</td>
			</tr>
			<tr>
				<td>ΔH /kcal･mol-1</td><td colspan="4"></td><td>-9.1</td><td>-6.5</td><td>-7.8</td><td>-8.6</td><td>-5.8</td><td>-11</td><td>-11.9</td><td>-7.8</td><td>-5.6</td><td>-11.1</td><td>-11</td><td>-6.5</td><td>-6</td><td>-5.6</td><td>-5.8</td><td>-9.1</td>
			</tr>
			<tr>
				<td>ΔS /cal･mol-1K-1</td><td colspan="4"></td><td>-24</td><td>-17.3</td><td>-20.8</td><td>-23.9</td><td>-12.9</td><td>-26.6</td><td>-27.8</td><td>-20.8</td><td>-13.5</td><td>-26.7</td><td>-26.6</td><td>-17.3</td><td>-16.9</td><td>-13.5</td><td>-12.9</td><td>-24</td>
			</tr>
			</tbody>
		</table>
		<br>
	<table class="auto-width-table">
		<thead>
			<tr>
				<th></th><th>A</th><th>C</th><th>G</th><th>T</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>Mw</td><td>313.21</td><td>289.18</td><td>329.21</td><td>304.2</td>
			</tr>
			<tr>
				<td>Mw (ds)</td><td>617.41</td><td>618.39</td><td>618.39</td><td>617.41</td>
			</tr>
		</tbody>
	</table>
	<hr>
	<h2>Formula</h2>
	
	<math display="block"><mrow is="true"><msub is="true"><mi is="true">ɛ</mi><mrow is="true"><mn is="true">260</mn></mrow></msub><mo is="true">=</mo><munderover is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">i</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mrow is="true"><msub is="true"><mi is="true">N</mi><mi is="true">b</mi></msub><mo is="true">−</mo><mn is="true">1</mn></mrow></munderover><mrow is="true"><msub is="true"><mi is="true">ɛ</mi><mrow is="true"><mi is="true">i</mi><mo is="true">,</mo><mi is="true">i</mi><mo is="true">+</mo><mn is="true">1</mn></mrow></msub></mrow><mo is="true">−</mo><munderover is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">i</mi><mo is="true">=</mo><mn is="true">2</mn></mrow><mrow is="true"><msub is="true"><mi is="true">N</mi><mi is="true">b</mi></msub><mo is="true">−</mo><mn is="true">1</mn></mrow></munderover><mrow is="true"><msub is="true"><mi is="true">ɛ</mi><mi is="true">i</mi></msub></mrow></mrow></math>
	The 
	<math><msub is="true"><mi is="true">ɛ</mi><mrow is="true"><mi is="true">i</mi><mo is="true">,</mo><mi is="true">i</mi><mo is="true">+</mo><mn is="true">1</mn></mrow></msub></math>
	 are the extinction coefficients for doublets of nucleotides, the 
	<math><msub is="true"><mi is="true">ɛ</mi><mrow is="true"><mi is="true">i</mi></mrow></msub></math>
	 is the extinction coefficient for the nucleotide i, and 
	<math><msub is="true"><mi is="true">N</mi><mi is="true">b</mi></msub></math>
	 is the number of nucleotides in the oligomer sequence<sup>[<a href="https://doi.org/10.1016/j.bpc.2007.12.004" target="_blank">1</a>]</sup>.
	<math display="block"><msub><mi>T</mi><mrow data-mjx-texclass="ORD"><mrow data-mjx-texclass="ORD"><mrow data-mjx-texclass="ORD"><mi mathvariant="normal">M</mi></mrow></mrow></mrow></msub><mo>=</mo><mrow data-mjx-texclass="ORD"><mi mathvariant="normal">&#x394;</mi></mrow><mi>H</mi><mrow data-mjx-texclass="ORD"><msup><mi></mi><mo>&#x2218;</mo></msup></mrow><mrow data-mjx-texclass="ORD"><mo>/</mo></mrow><mo stretchy="false">(</mo><mrow data-mjx-texclass="ORD"><mi mathvariant="normal">&#x394;</mi></mrow><mi>S</mi><mrow data-mjx-texclass="ORD"><msup><mi></mi><mo>&#x2218;</mo></msup></mrow><mo>+</mo><mi>R</mi><mspace width=".167em"></mspace><mrow data-mjx-texclass="ORD"><mrow data-mjx-texclass="ORD"><mi data-mjx-auto-op="false">ln</mi><mspace width=".167em"></mspace></mrow></mrow><msub><mi>C</mi><mrow data-mjx-texclass="ORD"><mrow data-mjx-texclass="ORD"><mrow data-mjx-texclass="ORD"><mi mathvariant="normal">T</mi></mrow></mrow></mrow></msub><mo stretchy="false">)</mo><mrow data-mjx-texclass="ORD"><mrow data-mjx-texclass="ORD"><mo>,</mo></mrow></mrow></math>
	<i>R</i> is gas constant. <i>C</i><sub>T</sub> is primer concentration<sup>[<a href="https://doi.org/10.1073/pnas.83.11.3746" target="_blank">2</a>, <a href="https://doi.org/10.1073/pnas.95.4.1460" target="_blank">3</a>]</sup>.

	<h2>References</h2>
	<ol>
		<li><a href="https://doi.org/10.1016/j.bpc.2007.12.004" target="_blank">Tataurov, A. V. <i>et al. Biophys. Chem.</i> <b>2008</b>, <i>133</i>, 66.</a></li>
		<li><a href="https://doi.org/10.1073/pnas.83.11.3746" target="_blank">Breslauer, K. J. <i>et al. Proc. Natl. Acad. Sci.</i> <b>1986</b>, <i>83</i>, 3746.</a></li>
		<li><a href="https://doi.org/10.1073/pnas.95.4.1460" target="_blank">SantaLucia, J. <i>Proc. Natl. Acad. Sci.</i> <b>1998</b>, <i>95</i>, 1460.</a></li>
	</ol>

	<dialog class="modal-overlay" id="modalOverlay">
		<div class="modal-box" id="modalBox"></div>
	</dialog>
</body>
</html>
