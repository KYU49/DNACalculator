<!--
    Copyright (c) 2025 KYU @ https://github.com/KYU49

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <https://www.gnu.org/licenses/agpl-3.0.html>.
-->

<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<title>DNA Calculator</title>
	<script src="script.js"></script>
	<link rel="stylesheet" href="style.css">
</head>
<body>
	<h1>DNA Calculator</h1>

	<label>[Na<sup>+</sup>] /mM: <input type="text" id="naInput" value="50" class="conc-input"></label>
	<!--
	<label>[Mg<sup>2+</sup>] /mM: <input type="text" id="mgInput" value="0" class="conc-input"></label>
	<label>[dNTPs] /mM: <input type="text" id="dntpInput" value="0" class="conc-input"></label>
	-->
	<label>[Primer] /μM<sup>†</sup>: <input type="text" id="dnaInput" value="0.5" class="conc-input"></label><br>
	<small><sup>†</sup>When [DNA] &lt;&lt; [Primer], input the initial primer concentration. When [DNA] = [Primer], input 1/4 primer concentration.</small>
	<br><br>

	<div class="input-row">
		<div class="input-block">
			<label for="sequence" class="bold">5'- Sequence -3'</label>
			<textarea id="seq" rows="10" placeholder="Enter DNA sequence"></textarea>
		</div>
		<div class="input-block">
			<label for="abs" class="bold">Abs. @ 260 nm</label>
			<textarea id="abs" row="10" class="abs-textarea" placeholder="Abs. (optional)"></textarea>
		</div>
	</div>
	<ul>
		<li>Input one sequence per row.</li>
		<li>"Abs." is used only for concentration calculations.</li>
		<li>The mw value is calculated with the 5' end as -OH. </li>
		<li>By bookmarking the search results URL, the sequence information you entered will be preserved.</li>
		<li>An Excel version is also available on <a href="https://github.com/KYU49/DNACalculator" target="_blank">GitHub</a>.</li>
	</ul>
	<br>
	<button id="calculateBtn">Calculate</button>
	<button id="downloadBtn" disabled>Download TSV</button>
	<button id="clearBtn">Clear</button>

	<div id="results"></div>

	<hr>

	<h2>Values used for calculation</h2>
	<table class="auto-width-table">
		<thead>
			<tr>
				<th></th><th>pdA</th><th>pdC</th><th>pdG</th><th>pdT</th><th>dApdA</th><th>dApdC</th><th>dApdG</th><th>dApdT</th><th>dCpdA</th><th>dCpdC</th><th>dCpdG</th><th>dCpdT</th><th>dGpdA</th><th>dGpdC</th><th>dGpdG</th><th>dGpdT</th><th>dTpdA</th><th>dTpdC</th><th>dTpdG</th><th>dTpdT</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>ε<sub>260,ss</sub></td><td>15400</td><td>7400</td><td>11500</td><td>8700</td><td>27400</td><td>21200</td><td>25000</td><td>22800</td><td>21200</td><td>14600</td><td>18000</td><td>15200</td><td>25200</td><td>17600</td><td>21600</td><td>20000</td><td>23400</td><td>16200</td><td>19000</td><td>16800</td>
			</tr>
			<tr id="hvalues">
				<td>ΔH /kcal･mol<sup>-1</sup></td><td colspan="4"></td>
			</tr>
			<tr id="svalues">
				<td>ΔS /cal･mol<sup>-1</sup>K<sup>-1</sup></td><td colspan="4"></td>
			</tr>
		</tbody>
	</table>
	<form name="hsValues">
		<legend class="bold">Select values for T<sub>m</sub> calculation</legend>
		<input type="radio" id="breslauer" name="hsValues" value="breslauer" checked><label for="breslauer">Breslauer's (1986<sup>[<a href="https://doi.org/10.1073/pnas.83.11.3746" target="_blank">1</a>]</sup>; for TOYOBO's PCR)</label>
		<input type="radio" id="sugimoto" name="hsValues" value="sugimoto"><label for="sugimoto">Sugimoto's (1996<sup>[<a href="https://doi.org/10.1093/nar/24.22.4501" target="_blank">2</a>]</sup>)</label>
		<input type="radio" id="santalucia" name="hsValues" value="santalucia"><label for="santalucia">SantaLucia's (1998<sup>[<a href="https://doi.org/10.1073/pnas.95.4.1460" target="_blank">3</a>]</sup>)</label>
	</form>

	<table class="auto-width-table">
		<thead>
			<tr>
				<th></th><th>A</th><th>C</th><th>G</th><th>T</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>Mw</td><td>313.21</td><td>289.18</td><td>329.21</td><td>304.2</td>
			</tr>
			<tr>
				<td>Mw (ds)</td><td>617.41</td><td>618.39</td><td>618.39</td><td>617.41</td>
			</tr>
		</tbody>
	</table>

	<hr>

	<h2>Formula</h2>
	
	<math display="block"><mrow><msub><mi>ɛ</mi><mrow><mn>260</mn><mo>,</mo><mi>ss</mi></mrow></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><msub><mi>N</mi><mi>b</mi></msub><mo>−</mo><mn>1</mn></mrow></munderover><mrow><msub><mi>ɛ</mi><mrow><mi>i</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>2</mn></mrow><mrow><msub><mi>N</mi><mi>b</mi></msub><mo>−</mo><mn>1</mn></mrow></munderover><mrow><msub><mi>ɛ</mi><mi>i</mi></msub></mrow></mrow></math>
	<math display="block"><mrow><msub><mi>ɛ</mi><mrow><mn>260</mn><mo>,</mo><mi is =true>ds</mi></mrow></msub><mo>=</mo><mo>(</mo><mn>1</mn><mo>-</mo><mi>h</mi><mo>)</mo><mo>(</mo><msub><mi>ɛ</mi><mrow><mn>260</mn><mo>,</mo><mi>ss</mi></mrow></msub><mo>+</mo><msub><mi>ɛ</mi><mrow><mn>260</mn><mo>,</mo><mi>ss</mi><mo>(</mo><mi>rev</mi><mo>)</mo></mrow></msub><mo>)</mo></math>
	<math display="block"><mrow><mi>h</mi><mo>=</mo><mo>(</mo><mn>0.059</mn><mo>&times;</mo><msub><mi>Count</mi><mi>GC</mi></msub><mo>+</mo><mn>0.278</mn><mo>&times;</mo><msub><mi>Count</mi><mi>AT</mi></msub><mo>)</mo><mo>/</mo><mi>Length</mi></mrow></math>
	where 
	<math><msub><mi>ɛ</mi><mrow><mi>i</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></math>
	 are the extinction coefficients for doublets of nucleotides, 
	<math><msub><mi>ɛ</mi><mrow><mi>i</mi></mrow></msub></math>
	 is the extinction coefficient for the nucleotide i, and 
	<math><msub><mi>N</mi><mi>b</mi></msub></math>
	 is the number of nucleotides in the oligomer sequence<sup>[<a href="https://doi.org/10.1016/j.bpc.2007.12.004" target="_blank">4</a>]</sup>.


	<math display="block">
		<msub><mi>T</mi><mi mathvariant="normal">m</mi></msub>
		<mo>=</mo>		
		<mrow><msup><mrow><mi>&#x394;</mi><mi>H</mi></mrow><mo>&#x2218;</mo></msup></mrow>
		<mo>&divide;</mo>
		<mrow><mo>(</mo><msup><mrow><mi>&#x394;</mi><mi>S</mi></mrow><mo>&#x2218;</mo></msup><mo>+</mo><mi>R</mi><mspace width=".167em"></mspace><mi>ln</mi><mspace width=".167em"></mspace><msub><mi>C</mi><mi>T</mi></msub><mo>)</mo></mrow>
		<mo>=</mo>
		<mrow><mi>1000</mi><mo>&times;</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><msub><mi>N</mi><mi>b</mi></msub><mo>−</mo><mn>1</mn></mrow></munderover><mrow><msub><mrow><mi>&#x394;</mi><mi>H</mi></mrow><mrow><mi>i</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow>
		<mo>&divide;</mo>
		<mrow><mo>(</mo><mrow>
			<mi>Initial</mi><mi>S</mi> + <munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><msub><mi>N</mi><mi>b</mi></msub><mo>−</mo><mn>1</mn></mrow></munderover><mrow><msub><mrow><mi>&#x394;</mi><mi>H</mi></mrow><mrow><mi>i</mi><mo>,</mo><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mo>+</mo><mn>1.987</mn><mspace width=".167em"></mspace><mi>ln</mi><mrow><mo>[</mo><mi>Primer</mi><mo>]</mo></mrow>
		</mrow><mo>)</mo>
		<mo>+</mo><mn>16.2</mn><mspace width=".167em"></mspace><msub><mi>log</mi><mn>10</mn></msub><mrow><mo>[</mo><msup><mi>Na</mi><mo>+</mo></msup><mo>]</mo><mo>-</mo><mn>273.15</mn>
		</mrow>

		<!-- const tmNearestNeighbor = 1000 * sumProduct(pds, deltaHTable) / (initiationS + sumProduct(pds, deltaSTable) + 1.987 * Math.log(concDNA / 1000000) ) - 273.15 + 16.6 * Math.log10(concNa / 1000); -->
	</math>
	where <i>R</i> is gas constant (= 1.987 kcal/(K･mol)), <i>C</i><sub>T</sub> is primer concentration, Initial <i>S</i> is -10.8 or -9.0 (Sugimot's value), and ∂ΔG/∂ln[Na<sup>+</sup>] = −0.175 kcal/mol → ∂<i>T</i><sub>m</sub>/∂log[Na<sup>+</sup>] = 16.2°C (when a sequence-independent ΔS° of −24.85 e.u. is assumed)<sup>[<a href="https://doi.org/10.1073/pnas.83.11.3746" target="_blank">1</a>, <a href="https://doi.org/10.1093/nar/24.22.4501" target="_blank">2</a>, <a href="https://doi.org/10.1073/pnas.95.4.1460" target="_blank">3</a>]</sup>.

	<h2>References</h2>
	<ol>
		<li><a href="https://doi.org/10.1073/pnas.83.11.3746" target="_blank">Breslauer, K. J. <i>et al. Proc. Natl. Acad. Sci.</i> <b>1986</b>, <i>83</i>, 3746.</a></li>
		<li><a href="https://doi.org/10.1093/nar/24.22.4501" target="_blank">Sugimoto, N. <i>et al. Nucleic Acids Res.</i> <b>1996</b>, <i>24</i>, 4501.</a></li>
		<li><a href="https://doi.org/10.1073/pnas.95.4.1460" target="_blank">SantaLucia, J. <i>Proc. Natl. Acad. Sci.</i> <b>1998</b>, <i>95</i>, 1460.</a></li>
		<li><a href="https://doi.org/10.1016/j.bpc.2007.12.004" target="_blank">Tataurov, A. V. <i>et al. Biophys. Chem.</i> <b>2008</b>, <i>133</i>, 66.</a></li>
	</ol>

	<dialog class="modal-overlay" id="modalOverlay">
		<div class="modal-box" id="modalBox"></div>
	</dialog>
</body>
</html>
